/*! grapesjs-rally-widgets - 1.0.3 */
!function(e,n){'object'==typeof exports&&'object'==typeof module?module.exports=n():'function'==typeof define&&define.amd?define([],n):'object'==typeof exports?exports["grapesjs-rally-widgets"]=n():e["grapesjs-rally-widgets"]=n()}(window,(function(){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&'object'==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,'default',{enumerable:!0,value:e}),2&n&&'string'!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n){e.exports=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,n,t){"use strict";t.r(n);var o=t(0),r=t.n(o);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var i=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.DomComponents,o=e.getConfig('stylePrefix'),r=function(e){return e.map((function(e){var n=e.coinSymbol;return{value:n,name:n}}))},a={name:'id'},i={name:'title'},l={type:'select',name:'coin',options:r(n.coinsList),changeProp:!0},s={type:'select',name:'currencyType',label:'Currency',options:[{value:'COIN',name:'COIN'},{value:'USD',name:'USD'}],changeProp:!0},p={type:'number',name:'amount',placeholder:'10',min:0,changeProp:!0},d={name:'note',placeholder:'note...',changeProp:!0},u=[{attributes:{class:'fa fa-code'},command:'widget-code'},{attributes:{class:'fa fa-arrow-up'},command:function(e){return e.runCommand('core:component-exit',{force:1})}},{attributes:{class:'fa fa-arrows gjs-no-touch-actions',draggable:!0},command:'tlb-move'},{attributes:{class:'fa fa-clone'},command:'tlb-clone'},{attributes:{class:'fa fa-trash-o'},command:'tlb-delete'}];function f(e){var n=e.coin,t=e.image,o=e.endpoint,r=this.querySelector('.change'),a=this.querySelector('.cp');function c(){fetch(o+"creator_coins/".concat(n,"/price")).then((function(e){return e.json()})).then((function(e){!function(e){r.style.display='none',a.innerHTML="$".concat(e.priceInUSD.toFixed(4))}(e)})).catch((function(e){console.log(e)}))}this.querySelector('img').src=t,this.querySelector('.c-name').innerHTML="$".concat(n),c(),setInterval(c,6e4)}function y(e){var n=e.coin,t=0,o=this,r=o.querySelectorAll('.tab'),a=o.querySelector('.prev'),c=o.querySelector('.next'),i=o.querySelectorAll('.step'),l=o.querySelector('a');function s(e){for(var n=0;n<r.length;n++)r[n].style.display='none';r[e].style.display='block',a.style.display=0===e?'none':'inline',e===r.length-1?c.style.display='none':c.style.display='inline',function(e){for(var n=0;n<i.length;n++)i[n].classList.remove('active');i[e].classList.add('active')}(e)}function p(e){return!(1===e&&!function(){var e=!0;input=o.querySelector('input'),''===input.value&&(input.classList.add('invalid'),e=!1);e&&i[t].classList.add('finish');return function(){var e=o.querySelector('select').value,t=o.querySelector('input').value,r=o.querySelector('textarea').value,a="https://www.rally.io/creator/".concat(n,"/?inputType=").concat(e,"&amount=").concat(t);r&&(a+="&note=".concat(r)),l.href=a,l.innerHTML=a}(),e}())&&(!(t>=r.length)&&void s(t+=e))}s(t),a.addEventListener('click',(function(){p(-1)})),c.addEventListener('click',(function(){p(1)}))}t.addType('widget',{model:c({defaults:{icon:'<i class="fa fa-puzzle-piece"></i>',toolbar:u,traits:[a,i,l],coin:'SKOT','script-props':['coin']}},n.widgetComponent)}),t.addType('price-ticker',{extend:'widget',model:{defaults:{icon:'<i class="fa fa-usd"></i>',image:'https://images-cc-dev.s3-us-west-2.amazonaws.com/images/SkotLeach_Coin.png',endpoint:n.rallyUrl,script:f,'script-props':['coin','image','endpoint'],attributes:{style:'padding:10px'},components:"<div class=\"pt-container\">\n            <img src=\"img.png\" alt=\"coin-icon\" class=\"pt-icon\"/>\n            <div class=\"pt-meta\">\n              <span class=\"c-name\">COIN</span>\n              <p class=\"cp\">$0.00</p>\n            </div>\n            <div class=\"cp-container\">\n              <svg fill=\"currentColor\" focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" class=\"indicator rotate green\">\n                <path d=\"M7 10l5 5 5-5z\">\n                </path>\n              </svg>\n              <p class=\"change green\">0.00%</p>\n            </div>\n          </div>\n          <style>\n            .pt-container{\n              display:flex;\n              margin-left: 10px;\n              font-family:Helvetica, sans-serif;\n            }\n            .cp-container{\n              display:flex;\n              align-items:center;\n            }\n            .cp {\n              margin: 0;\n              margin-top: 5px\n            }\n            .pt-meta{\n              display:flex;\n              flex-direction:column;\n              margin-left: 10px;\n            }\n            .pt-icon{\n              width:50px;\n              height:50px;\n              border-radius: 5px;\n            }\n            .c-name{\n              font-weight:700;\n              font-size:20px;\n            }\n            .cp{\n              font-size:25px;\n              font-weight:700;\n            }\n            .indicator{\n              width: 25px;\n              height: 25px;\n            }\n            .red {\n              color: rgb(219, 105, 105);\n            }\n            .green {\n              color: rgb(81, 146, 81);\n            }\n            .rotate {\n              transform: rotate(180deg);\n            }\n          </style>"},init:function(){this.updateCoinImage(),this.on("change:coin",this.updateCoinImage)},updateCoinImage:function(){var e=this.get('coin'),t=n.coinsList.find((function(n){return n.coinSymbol===e}));this.set('image',t.coinImagePath)}}}),t.addType('rally-deeplink',{extend:'widget',model:{defaults:{icon:'<i class="fa fa-link"></i>',script:y,components:"<form action=\"\" class=\"deeplink\">\n            <div class=\"header\">Donate</div>\n            <div class=\"tab\">\n              <p>\n                <select class=\"input\" name=\"currency\" id=\"currency\">\n                  <option value=\"COIN\">COIN</option>\n                  <option value=\"USD\">USD</option>\n                </select>\n              </p>\n              <p><input class=\"input\" type=\"text\" placeholder=\"amount\"/></p>\n            </div>\n            <div class=\"tab\">\n              <p><textarea class=\"input\" name=\"note\" id=\"note\" placeholder=\"optional note...\"></textarea></p>\n            </div>\n            <div class=\"tab\">\n              <a target=\"_blank\" href=\"#\">Link</a>\n            </div>\n            <div>\n              <button data-".concat(o,"type=\"button-basic\" type=\"button\" class=\"prev\">Prev</button>\n              <button data-").concat(o,"type=\"button-basic\" type=\"button\" class=\"next\">Next</button>\n            </div>\n            <div><span class=\"step\"></span><span class=\"step\"></span><span class=\"step\"></span></div>\n          </form>\n          <style>\n            .deeplink {\n              background-color: #ffffff;\n              margin: 100px auto;\n              padding: 40px;\n              width: 70%;\n              min-width: 300px\n            }\n\n            .input {\n              padding: 10px;\n              width: 100%;\n              font-size: 17px;\n              border: 1px solid #aaaaaa;\n            }\n\n            .input.invalid {\n              background-color: #ffdddd;\n            }\n\n            .tab {\n              display: none;\n            }\n\n            .step {\n              height: 15px;\n              width: 15px;\n              margin: 0 2px;\n              background-color: #bbbbbb;\n              border: none;\n              border-radius: 50%;\n              display: inline-block;\n              opacity: 0.5;\n            }\n\n            .step.active {\n              opacity: 1\n            }\n\n            .step.finish {\n              background-color: #4caf50;\n            }\n          </style>")}}}),t.addType('rally-deeplink-predefined',{extend:'widget',model:{defaults:{icon:'<i class="fa fa-shopping-cart"></i>',traits:[a,i,l,s,p,d],currencyType:'COIN',amount:10,note:'service/product description','script-props':['coin','currencyType','amount','note'],script:function(e){var n=e.coin,t=e.currencyType,o=e.amount,r=e.note;this.querySelector('button').addEventListener('click',(function(){window.open("https://www.rally.io/creator/".concat(n,"/?inputType=").concat(t,"&amount=").concat(o,"&note=").concat(r),'_blank')}))},components:"<button data-".concat(o,"type=\"button-basic\" class=\"btn-rly\">Buy Product</button>\n        <style>\n          .btn-rly {\n            cursor: pointer;\n            padding: 13px 18px;\n            background-color: #424242;\n            font-family: inherit;\n            color: #fff;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 15px;\n            border: 1px solid #e9ebeb;\n            border-bottom-color: #e1e3e3;\n            border-radius: 4px;\n            background-color: #fff;\n            color: rgba(14, 30, 37, .87);\n            box-shadow: 0 2px 4px 0 rgba(14, 30, 37, .12);\n            transition: all .2s ease;\n            transition-property: background-color, color, border, box-shadow;\n            outline: 0;\n            font-weight: 500;\n            background: #f40;\n            color: #fff;\n            border-color: transparent;\n          }\n        </style>")}}}),t.addType('rally-buy-coin',{extend:'widget',model:{defaults:{icon:'<i class="fa fa-credit-card"></i>',script:function(e){var n=e.coin;this.querySelector('button').addEventListener('click',(function(){window.open("https://www.rally.io/creator/".concat(n,"/"),'_blank')}))},components:"<button data-".concat(o,"type=\"button-basic\" class=\"btn-rly\">Buy Coin</button>\n        <style>\n          .btn-rly {\n            cursor: pointer;\n            padding: 13px 18px;\n            background-color: #424242;\n            font-family: inherit;\n            color: #fff;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 15px;\n            border: 1px solid #e9ebeb;\n            border-bottom-color: #e1e3e3;\n            border-radius: 4px;\n            background-color: #fff;\n            color: rgba(14, 30, 37, .87);\n            box-shadow: 0 2px 4px 0 rgba(14, 30, 37, .12);\n            transition: all .2s ease;\n            transition-property: background-color, color, border, box-shadow;\n            outline: 0;\n            font-weight: 500;\n            background: #f40;\n            color: #fff;\n            border-color: transparent;\n          }\n        </style>")}}})},l=function(e){var n=e.BlockManager;n.add('price-ticker',{category:'Rally',label:'Price Ticker',attributes:{class:'fa fa-usd'},content:{type:'price-ticker'}}),n.add('rally-deeplink-predefined',{category:'Rally',label:'Product Button',attributes:{class:'fa fa-shopping-cart'},content:{type:'rally-deeplink-predefined'}}),n.add('rally-buy-coin',{category:'Rally',label:'Buy Coin',attributes:{class:'fa fa-credit-card'},content:{type:'rally-buy-coin'}}),n.add('rally-deeplink',{category:'Rally',label:'Deeplink',content:{type:'rally-deeplink'},media:'<svg viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/></svg>'})};function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.Commands,o=e.$,r=e.getConfig('stylePrefix'),a=e.Modal,c=e.CodeManager.getViewer('CodeMirror').clone(),i=o('<div></div>'),l='HTML',s=c.editor,d=function(e){var n=document.createElement('textarea');n.value=e,n.setAttribute('readonly',''),n.style.position='absolute',n.style.left='-9999px',document.body.appendChild(n),n.select(),document.execCommand('copy'),document.body.removeChild(n)},u=o("<button title=\"Copy\" class=\"gjs-copy-btn\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M19 21H8V7h11m0-2H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m-3-4H4c-1.1 0-2 .9-2 2v14h2V3h12V1z\"></path></svg>\n    </button>");u.on('click',(function(e){var n=s.getValue().trim(),t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 21H8V7h11m0-2H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m-3-4H4c-1.1 0-2 .9-2 2v14h2V3h12V1z"></path></svg>';d(n),u.html('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 7L9 19l-5.5-5.5 1.41-1.41L9 16.17 19.59 5.59 21 7z"></path></svg>'),setTimeout((function(){return u.html(t)}),2e3)}));var f=o("<div class=\"".concat(r,"import-label\">").concat(l,"</div>"));c.set(p(p({},{codeName:'htmlmixed',theme:'hopscotch',autoBeautify:1,autoCloseTags:1,autoCloseBrackets:1,styleActiveLine:1,smartIndent:1,readOnly:1}),n.copyViewerOptions));var y=function(){var n=e.getSelected(),t=n.toHTML(),o=e.CodeManager.getCode(n,'css',{cssc:e.CssComposer}),r="\n                var el = document.querySelector(#".concat(n.ccid,");\n                var props = ").concat(JSON.stringify(e.getSelected().__getScriptProps()),";\n                (").concat(n.getScriptString(),".bind(el))(props);\n            ");return"".concat(t,"<style>\n").concat(o,"</style><script>\n").concat(r,"<\/script>")};t.add('widget-code',{run:function(e){var t=this;if(!s){var o=document.createElement('textarea');i.append(f),i.append(o),i.append(u),c.init(o),s=c.editor}a.setTitle(n.modalCopyTitle),a.setContent(i),c.setContent(y()),a.open().getModel().once('change:open',(function(){return e.stopCommand(t.id)})),s.refresh()},stop:function(){a.close()}})};function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n["default"]=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=f(f({},{modalCopyTitle:'Widget',copyViewerOptions:{},widgetComponent:{},rallyUrl:'https://api.rally.io/v1/'}),n),o=e.Storage.get('remote').fetch;d(e,t),o(t.rallyUrl+'creator_coins').then((function(e){return e.json()})).then((function(n){t.coinsList=n,i(e,t),l(e,t)})).catch((function(e){return console.log('Error: ',e)}))}}])}));
//# sourceMappingURL=grapesjs-rally-widgets.min.js.map